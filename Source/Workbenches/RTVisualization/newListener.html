<HTML>
<Head>
<Title>New Listener</Title>
</Head>
<Body>
<script type="text/javascript" language="JavaScript1.4"><!--

/* This variable holds the listener properties */
var listenerName;
var listenerType;
var listenerPort;

/* Function validates that input is an integer */
function isInteger(inputVal) {
	inputStr = inputVal.toString();
	for (var i=0; i<inputStr.length; i++) {
		var oneChar = inputStr.charAt(i);
		if (i == 0 && oneChar == "-") { continue }
		if (oneChar < "0" || oneChar > "9") { return false }
	}
	return true;
}

/* Function calls modalDialog */
function CreateListener(type) {
	/* Validate Variables */
	listenerType = document.entry.type.value;
	listenerPort = document.entry.port.value;
	listenerName = document.entry.name.value;

	/* Send message of CreateListener */
	if (isInteger( document.entry.port.value))
		console.sendMessage("CreateListener");
	else {
		/* Send message about bad port format */
		console.sendMessage("InvalidPortFormat");
	}
}

function CloseDialog() {
	/* Send message of CloseDialog */
	console.sendMessage("CloseDialog");
}

//--></script>

<Form name="entry">
Listener Name:
<input type=text name="name" value="Listener"><P>
Listener Port:
<input type=text name="port" value="9877"><P>
Listener Type:
<select name="type">
	<option selected value="UDP">UDP Listener
	<option value="TCP">TCP Listener
</select>
<P>
<input type=button value="Ok" onClick="CreateListener();">
<input type=button value="Cancel" onClick="CloseDialog();">
</Form>

</Body>
</HTML>